<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Monthly Engagement Report</title>
    <style>
        /* Add some styles for the report */
        body {
            font-family: Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
            padding: 0;
        }

        h1 {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }

        table th,
        table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        table th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        .cover {
            text-align: center;
            margin-top: 100px;
        }

        .cover h1 {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        .cover p {
            font-size: 18px;
            margin-bottom: 20px;
        }

        .cover img {
            max-width: 100%;
            margin-bottom: 50px;
        }

        .page-break {
            page-break-before: always;
        }
    </style>
</head>

<body>
    <!-- Cover page -->
    <article class="cover">
        <h1>Monthly Engagement Report</h1>
        <p>Dear {{ user.username }},</p>
        <p>Here's your monthly engagement report for {{ month }}/{{ year }}:</p>
    </article>

    <!-- Metrics page -->
    <article>
        <h1>Monthly Metrics</h1>
        <table>
            <thead>
                <tr>
                    <th>Section</th>
                    <th>Book Issued</th>
                    <th>Issued Date</th>
                    <th>Return Date</th>
                </tr>
            </thead>
            <tbody>
                {% for book in books %}
                <tr>
                    <td>{{ book.section.name }}</td>
                    <td>{{ book.ebook.name }}</td>
                    <td>{{ book.book.date_accessed.strftime('%Y-%m-%d') }}</td>
                    <td>{{ book.book.date_returned.strftime('%Y-%m-%d') }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <table>
            <thead>
                <tr>
                    <th>Book ID</th>
                    <th>Rating</th>
                </tr>
            </thead>
            <tbody>
                {% for rating in filtered_book %}
                <tr>
                    <td>{{ rating.bookid }}</td>
                    <td>{{ rating.rating }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <br>
        <p>Thank you for your engagement!</p>
        <p>Best regards,<br/>E-Library Team</p>
    </article>
</body>

</html>